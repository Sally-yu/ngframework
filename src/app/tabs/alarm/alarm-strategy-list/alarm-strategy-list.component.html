<!--报警策略列表-->
<div id="content">

  <!--跳转策略详情页面，新增编辑相同-->
  <app-add-alarm-strategy *ngIf="alarmStgDetail" [alarmStg]="alarmStg" [option]="option" [parentCom]="'策略列表'"
                          (result)="cancel($event)"></app-add-alarm-strategy>

  <div *ngIf="!alarmStgDetail">
    <nz-layout style="padding:24px 0; background: transparent">
      <nz-content style="padding: 0 24px; min-height: 280px;">
        <div id="list-tool">
          <label>
            <input type="text" nz-input placeholder="输入关键字搜索" [(ngModel)]="searchValue" (ngModelChange)="search()">
          </label>
          <button nz-button (click)="getList()">刷新</button>
          <button nz-button nzType="primary" (click)="add()">新增</button>
        </div>
        <nz-table #list [nzData]="alarmStgList" [nzLoading]="loading" [nzPageSize]="5">
          <thead>
          <tr>
            <th nzWidth="100px">#</th>
            <th>策略名称</th>
            <th>标识符</th>
            <th>报警条件</th>
            <th>报警级别</th>
            <th>时间间隔</th>
            <th>启用禁用</th>
            <th nzWidth="150px">操作</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let data of list.data">
            <td>{{alarmStgList.indexOf(data) + 1}}</td>
            <td>
              <a (click)="edit(data.key)">{{ data.name }}</a>
            </td>
            <td>{{ data.code }}</td>
            <td>{{ data.attribute.name }}{{ data.conditiona.key }}{{ data.conditiona.value }};
              <span
                *ngIf="data.conditionb.value">{{ data.attribute.name }}{{ data.conditionb.key }}{{ data.conditionb.value }}</span>
            </td>
            <td>
              <span style="color:gold" *ngIf="data.level==0">提醒</span>
              <span style="color:rgb(253, 152, 0)" *ngIf="data.level==1">警报</span>
              <span style="color:rgb(255, 0, 0)" *ngIf="data.level==2">严重</span>
            </td>
            <td>{{ data.interval }}</td>
            <td>
              <nz-switch class="switch" name="status" [(ngModel)]="data.status"></nz-switch>
            </td>

            <td>
              <a (click)="edit(data.key)">
                <i nz-icon nzType="edit" nzTheme="outline"></i>
                编辑
              </a>
              <nz-divider nzType="vertical"></nz-divider>
              <a nz-popconfirm nzTitle="确定删除？" (nzOnConfirm)="remove(data.key)" style="color: #ff2222;">
                <i nz-icon nzType="delete" nzTheme="outline"></i>
                删除</a>
            </td>
          </tr>
          </tbody>
        </nz-table>
      </nz-content>
    </nz-layout>
  </div>

</div>
