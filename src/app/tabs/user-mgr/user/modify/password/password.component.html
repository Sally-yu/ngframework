<p id="btn" (click)="close()">
  <i nz-icon nzType="left" nzTheme="outline"></i>个人中心
</p>

<nz-divider nzType="horizontal"></nz-divider>

<!--步骤条样式在style.less中强行覆盖-->
<nz-steps [nzCurrent]="current">
  <nz-step nzTitle="验证密码"></nz-step>
  <nz-step nzTitle="确认新密码"></nz-step>
  <nz-step nzTitle="完成"></nz-step>
</nz-steps>

<div class="step-content" *ngIf="current===0" [ngTemplateOutlet]="first">
</div>
<div class="step-content" *ngIf="current===1" [ngTemplateOutlet]="second">
</div>
<div class="step-content" *ngIf="current===2" [ngTemplateOutlet]="done">
</div>


<ng-template #first>
  <form nz-form style="padding: 0 30%;">
    <nz-form-item>
      <nz-form-label [nzSpan]="7">当前密码</nz-form-label>
      <nz-form-control [nzSpan]="12">
        <input nz-input [(ngModel)]="oldpwd" name="password" type="password" placeholder="请输入当前密码"/>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-control [nzOffset]="7" [nzSpan]="12">
        <button nz-button (click)="authyKey()" nzType="primary">下一步</button>
      </nz-form-control>
    </nz-form-item>
  </form>
</ng-template>


<ng-template #second>
  <form nz-form style="padding: 0 30%">
    <nz-form-item>
      <nz-form-label [nzSpan]="7">新密码</nz-form-label>
      <nz-form-control [nzSpan]="12" [nzHasFeedback]="!pwdLength" [nzValidateStatus]="lenStatus">
        <input nz-input name="newpwd" type="password" [(ngModel)]="newpwd" placeholder="请输入6~16位长度密码"/>
        <nz-form-explain *ngIf="!pwdLength">密码长度6~16位！</nz-form-explain>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSpan]="7">确认密码</nz-form-label>
      <nz-form-control [nzSpan]="12" [nzHasFeedback]="!confirmOK" [nzValidateStatus]="confirmStatus">
        <input nz-input name="confirm" type="password" [(ngModel)]="confirm" (ngModelChange)="valide()" placeholder="请再次输入密码确认"/>
        <nz-form-explain *ngIf="!confirmOK">两次输入的密码不匹配，请重新确认</nz-form-explain>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-control [nzOffset]="7" [nzSpan]="12">
        <button nz-button (click)="current=current-1;">上一步</button>
        <button nz-button (click)="ensure()" nzType="primary" style="margin-left: 8px;">下一步</button>
      </nz-form-control>
    </nz-form-item>
  </form>
</ng-template>

<ng-template #done>
  <div style="text-align: center;line-height: 100px;">
    <nz-progress [nzPercent]="100" nzType="circle"></nz-progress>
<br>
    <button nz-button (click)="logout()" >重新登录</button>
    <button nz-button (click)="close()" nzType="primary" style="margin-left: 8px;">修改完成</button>
  </div>
</ng-template>
